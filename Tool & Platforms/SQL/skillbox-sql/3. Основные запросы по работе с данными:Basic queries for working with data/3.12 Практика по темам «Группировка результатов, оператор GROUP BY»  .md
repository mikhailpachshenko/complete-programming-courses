#### 3.12 Практика по темам «Группировка результатов, оператор GROUP BY»



### Описание

В этом курсе мы предусмотрели опциональные мини-задания для самостоятельной практики. Их не нужно сдавать на проверку. Нажав на кнопку внизу страницы, вы найдёте алгоритм и советы по выполнению задания с перечнем использованных команд. Постарайтесь решить задание самостоятельно, но если возникнет вопрос, то вы всегда сможете посмотреть в эту подсказку.

В предыдущих видео вы узнали, как выводить уникальные записи по одному или нескольким полям, а также как группировать записи.

В этом задании вам необходимо выполнить несколько SQL-запросов к базе данных shop.sql:

1. Выведите ID статусов заказов, которые вообще встречаются в таблице order.
2. Выведите первые пять ID товаров и количество заказов, в которых они встречаются.
3. Выведите двумя способами все уникальные переходы статусов заказов.
4. Выведите названия статусов заказов и количество заказов с таким статусом, отсортируйте количество по возрастанию.

### Эталонное решение

1. Вывести ID статусов заказов, которые вообще встречаются в таблице order.

Результат выполнения запроса:

![img](https://api.selcdn.ru/v1/SEL_72086/prodLMS/files/share/3.10.1.png)

Здесь и далее — изображения Skillbox

Запрос:

```
SELECT DISTINCT `status_id`
FROM `order`;
```

1. Вывести первые пять ID товаров и количество заказов, в которых они встречаются.

**Комментарий:** для выполнения этого задания используйте таблицу `order2good`. Здесь нужно использовать группировку и вывод общего количества элементов в группе (использовалось в видео «Фильтрация по уникальности и группировка записей»).

Результат выполнения запроса:

![img](https://api.selcdn.ru/v1/SEL_72086/prodLMS/files/share/%D0%93%D1%80%D1%83%D0%BF%D0%BF%D0%B8%D1%80%D0%BE%D0%B2%D0%BA%D0%B0_%D1%80%D0%B5%D0%B7%D1%83%D0%BB%D1%8C%D1%82%D0%B0%D1%82%D0%BE%D0%B2_%D0%BE%D0%BF%D0%B5%D1%80%D0%B0%D1%82%D0%BE%D1%80_GROUP_BY.png)

Запрос:

```
SELECT
    `good_id`,
    COUNT(*)
FROM `order2good`
GROUP BY `good_id`
LIMIT 5;
```

1. Вывести двумя способами все уникальные переходы статусов заказов.

**Комментарий:** здесь понадобится таблица `order_status_change`. Все уникальные пары можно вернуть как с помощью оператора GROUP BY, так и с помощью DISTINCT.

Результат выполнения запроса:

![img](https://api.selcdn.ru/v1/SEL_72086/prodLMS/files/share/%D0%93%D1%80%D1%83%D0%BF%D0%BF%D0%B8%D1%80%D0%BE%D0%B2%D0%BA%D0%B0_%D1%80%D0%B5%D0%B7%D1%83%D0%BB%D1%8C%D1%82%D0%B0%D1%82%D0%BE%D0%B2_%D0%BE%D0%BF%D0%B5%D1%80%D0%B0%D1%82%D0%BE%D1%80_GROUP_BY_-_2_oZr0104.png)

Запрос:

```
SELECT
    `src_status_id`,
    `dst_status_id`
FROM `order_status_change`
GROUP BY `src_status_id`, `dst_status_id`;
```

И синонимичный запрос:

```
SELECT DISTINCT
     `src_status_id`,
     `dst_status_id`
FROM `order_status_change`;
```

1. Вывести названия статусов заказов и количество заказов с таким статусом, сортируйте количество по возрастанию.

**Комментарий:** используйте таблицы `order` и `order_status`. Здесь нужно воспользоваться тем, что можно обращаться к присвоенным именам для извлекаемых полей.

Результат выполнения запроса:

![img](https://api.selcdn.ru/v1/SEL_72086/prodLMS/files/share/%D0%93%D1%80%D1%83%D0%BF%D0%BF%D0%B8%D1%80%D0%BE%D0%B2%D0%BA%D0%B0_%D1%80%D0%B5%D0%B7%D1%83%D0%BB%D1%8C%D1%82%D0%B0%D1%82%D0%BE%D0%B2_%D0%BE%D0%BF%D0%B5%D1%80%D0%B0%D1%82%D0%BE%D1%80_GROUP_BY_-_3.png)

Запрос:

```
SELECT
    os.`name`,
    COUNT(*) `count`
FROM `order` o
JOIN `order_status` os ON
    os.id = o.status_id
GROUP BY os.`name`
ORDER BY `count`;
```



Поздравляем, теперь вы знаете про оператор GROUP BY и можете применить его на практике.